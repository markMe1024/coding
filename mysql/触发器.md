**概念**

A trigger is a named database object that is associated with a table, and that activates when a particular event occurs for the table. Some uses for triggers are to perform checks of values to be inserted into a table or to perform calculations on values involved in an update. 

A trigger is defined to activate when a statement inserts, updates, or deletes rows in the associated table. These row operations are trigger events. For example, rows can be inserted by [`INSERT`](https://dev.mysql.com/doc/refman/8.0/en/insert.html) or [`LOAD DATA`](https://dev.mysql.com/doc/refman/8.0/en/load-data.html) statements, and an insert trigger activates for each inserted row. A trigger can be set to activate either before or after the trigger event. For example, you can have a trigger activate before each row that is inserted into a table or after each row that is updated. 

当用户对一个表进行增删改操作时，如果该操作满足绑定到该表的触发器条件，则会触发该触发器内定义的操作执行。



**语法**

创建触发器示例：

```mysql
mysql> CREATE TABLE account (acct_num INT, amount DECIMAL(10,2));
Query OK, 0 rows affected (0.03 sec)

mysql> CREATE TRIGGER ins_sum BEFORE INSERT ON account
       FOR EACH ROW SET @sum = @sum + NEW.amount;
Query OK, 0 rows affected (0.01 sec)
```

NEW关键字，用来代表更新后的数据库记录。相应的，OLD关键字，用来代表更新前的数据库记录。

触发器名称存在于schema namespace，所以同一个schema下的触发器不可以重名，不同schema下的可以重名。

 It is possible to define multiple triggers for a given table that have the same trigger event and action time. For example, you can have two `BEFORE UPDATE` triggers for a table. By default, triggers that have the same trigger event and action time activate in the order they were created. To affect trigger order, specify a clause after `FOR EACH ROW` that indicates `FOLLOWS` or `PRECEDES` and the name of an existing trigger that also has the same trigger event and action time. With `FOLLOWS`, the new trigger activates after the existing trigger. With `PRECEDES`, the new trigger activates before the existing trigger. 

 For example, the following trigger definition defines another `BEFORE INSERT` trigger for the `account` table: 

```sql
mysql> CREATE TRIGGER ins_transaction BEFORE INSERT ON account
       FOR EACH ROW PRECEDES ins_sum
       SET
       @deposits = @deposits + IF(NEW.amount>0,NEW.amount,0),
       @withdrawals = @withdrawals + IF(NEW.amount<0,-NEW.amount,0);
Query OK, 0 rows affected (0.01 sec)
```

By using the [`BEGIN ... END`](https://dev.mysql.com/doc/refman/8.0/en/begin-end.html) construct, you can define a trigger that executes multiple statements. Within the `BEGIN` block, you also can use other syntax that is permitted within stored routines such as conditionals and loops. However, just as for stored routines, if you use the [**mysql**](https://dev.mysql.com/doc/refman/8.0/en/mysql.html) program to define a trigger that executes multiple statements, it is necessary to redefine the [**mysql**](https://dev.mysql.com/doc/refman/8.0/en/mysql.html) statement delimiter so that you can use the `;` statement delimiter within the trigger definition. The following example illustrates these points. It defines an `UPDATE` trigger that checks the new value to be used for updating each row, and modifies the value to be within the range from 0 to 100. This must be a `BEFORE` trigger because the value must be checked before it is used to update the row: 

```sql
mysql> delimiter //
mysql> CREATE TRIGGER upd_check BEFORE UPDATE ON account
       FOR EACH ROW
       BEGIN
           IF NEW.amount < 0 THEN
               SET NEW.amount = 0;
           ELSEIF NEW.amount > 100 THEN
               SET NEW.amount = 100;
           END IF;
       END;//
mysql> delimiter ;
```

注意：

- 如果一个BEFORE触发器执行失败，则它对应的sql也不会执行。
- 无论sql是否执行成功，BEFORE触发器都会触发执行。
- 只有当BEFORE触发器和sql都执行成功后，AFTER触发器才会被触发。
- 如果AFTER触发器执行失败，则它对应的sql也会失败。



删除触发器示例：

```sql
mysql> DROP TRIGGER test.ins_sum;
```

当触发器关联的表被删除后，该触发器也会被删掉。



**缺点**

1. 一个MySQL触发器可能会关联到另外一张表或几张表的操作。因此，会导致数据库服务器负荷也会相应的增加一倍或几倍，如果出现因为触发器问题导致的性能问题，会很难定位问题位置和原因。
2. 在基于锁的操作中，触发器可能会导致锁等待或死锁。
3. 触发器执行失败，原来执行的SQL语名也会执行失败。而因为触发器导致的失败结果和失败原因，往往很难排查。 



**参考资料**

 [MySQL :: MySQL 8.0 Reference Manual :: 25.3 Using Triggers](https://dev.mysql.com/doc/refman/8.0/en/triggers.html) 

 [MySQL :: MySQL 8.0 Reference Manual :: 25.3.1 Trigger Syntax and Examples](https://dev.mysql.com/doc/refman/8.0/en/trigger-syntax.html) 

 [mysql触发器对性能影响_mysql触发器性能_DDL_will的博客-CSDN博客](https://blog.csdn.net/sinat_41780498/article/details/80651551) 